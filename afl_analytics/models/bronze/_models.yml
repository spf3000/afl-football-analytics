# Model Documentation and Tests
version: 2

models:
  - name: stg_match_results
    description: >
      Bronze layer staging table for AFL match results.
      Source: Python-parsed raw.match_results_parsed table.
      Adds dbt metadata and calculated fields (margin, result).
    
    columns:
      - name: _dbt_loaded_at
        description: "Timestamp when dbt model ran"
        tests:
          - not_null
      
      - name: season
        description: "Season year"
        tests:
          - not_null
      
      - name: round
        description: "Round number"
        tests:
          - not_null
      
      - name: date
        description: "Date the match was played"
        tests:
          - not_null
      
      - name: home_team
        description: "Home team name"
        tests:
          - not_null
      
      - name: away_team
        description: "Away team name"
        tests:
          - not_null
      
      - name: venue
        description: "Match venue"
      
      - name: crowd
        description: "Attendance (NULL for 2020 COVID year)"
      
      - name: home_score
        description: "Home team final score"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 300
              severity: warn
      
      - name: away_score
        description: "Away team final score"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 300
              severity: warn
      
      - name: margin
        description: "Score differential (home_score - away_score). Positive = home win, negative = away win"
        tests:
          - not_null
      
      - name: result
        description: "Match result: home_win, away_win, or draw"
        tests:
          - not_null
          - accepted_values:
              values: ['home_win', 'away_win', 'draw']
      
      - name: result_raw
        description: "Raw result string from source (e.g., '105-81')"
      
      - name: disposals_goals
        description: "Player statistics combined from source file"
      
      - name: _python_scraped_at
        description: "Timestamp when Python parsing script ran"
